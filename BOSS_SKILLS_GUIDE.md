# Boss技能详细说明

## 游戏中的Boss类型

游戏中有5种不同的Boss，分别出现在不同的关卡：

---

## 1. 通用Boss (`boss`)
**出现关卡**：非5/10/15/20的Boss关卡  
**基础属性**：
- 血量：基础血量的 **5倍**
- 体型：基础大小的 **2倍**
- 移动速度：0.6
- 护盾：100 + 层数×20（护盾被破坏后3秒重生）

### 技能机制

#### 🔹 护盾系统
- **护盾值**：100 + 层数×20
- **护盾重生**：护盾被破坏后，3秒后自动恢复满护盾
- **特效**：护盾重生时会有黄色闪光特效

#### 🔹 多阶段战斗系统
Boss根据血量百分比进入不同阶段：

**阶段1（100%-60%血量）**：
- 基础移动速度
- 每2秒发射 **1发** 投射物

**阶段2（60%-30%血量）**：
- 移动速度提升 **20%**
- 每2秒发射 **2发** 投射物（扇形散射）
- **技能**：每6秒召唤小怪（使用`summonMinions`）

**阶段3（30%-0%血量）**：
- 移动速度提升 **50%**
- 每2秒发射 **3发** 投射物（更宽扇形）
- **技能**：每6秒召唤小怪 + **范围爆炸攻击**
  - 爆炸范围：120像素
  - 爆炸伤害：根据层数计算（基础伤害×0.5）

#### 🔹 远程攻击
- **冷却时间**：2秒
- **攻击方式**：根据阶段发射1-3发投射物
- **投射物属性**：
  - 伤害：根据层数动态计算（基础伤害×0.3）
  - 速度：10
  - 穿透：最多穿透2个敌人
  - 暴击率：20%

---

## 2. 第5层Boss：重装指挥官 (`infantry_captain`)
**出现关卡**：第5层  
**基础属性**：
- 血量：基础血量的 **25倍**
- 体型：基础大小的 **1.8倍**
- 移动速度：0.8
- 颜色：红色 (#ff0000)

### 技能机制

#### 🔹 移动策略
- 当距离玩家超过150像素时，缓慢接近玩家
- 接近后会保持距离

#### 🔹 技能1：重炮轰击
- **冷却时间**：2秒
- **攻击范围**：400像素内
- **攻击方式**：发射3发炮弹，扇形分布（角度差0.4弧度）
- **伤害**：30 + 层数×5
- **特效**：
  - 充能特效：红橙黄粒子爆发（30个粒子）
  - 闪光特效：红色冲击波

#### 🔹 技能2：步兵方阵
- **冷却时间**：12秒
- **效果**：在Boss周围召唤4个小怪
- **特效**：
  - 召唤阵：蓝白色粒子爆发（50个粒子）
  - 颜色：蓝色渐变 (#00B7FF, #0088FF, #FFFFFF)

#### 🔹 接触伤害
- 近身接触时造成接触伤害

---

## 3. 第10层Boss：虫巢母体 (`fortress_guard`)
**出现关卡**：第10层  
**基础属性**：
- 血量：基础血量的 **40倍**
- 体型：基础大小的 **2.5倍**
- 移动速度：0.3（非常缓慢）
- 颜色：棕色 (#884400)
- 护盾：50

### 技能机制

#### 🔹 移动策略
- 非常缓慢地蠕动接近玩家
- 当距离超过200像素时才会移动

#### 🔹 技能1：虫巢繁殖
- **冷却时间**：5秒
- **效果**：在Boss周围3个位置生成快速虫（bug类型）
- **生成位置**：围绕Boss60像素距离，均匀分布（120度间隔）
- **快速虫属性**：
  - 速度：2.5（比普通快速虫更快）
  - 血量：基础血量的15%
  - 体型：基础大小的80%
- **特效**：
  - 虫巢脉动：绿色能量爆发（60个粒子）
  - 颜色：霓虹绿 (#39FF14, #00FF88, #88FF44)
  - 每个生成点都有绿色闪光特效

#### 🔹 技能2：爆虫孵化
- **冷却时间**：10秒
- **效果**：在玩家位置生成2-3个虫卵，2秒后孵化成自爆虫
- **虫卵数量**：
  - 敌人总数<50时：生成3个
  - 敌人总数≥50时：生成2个
- **生成位置**：玩家位置周围30像素范围内，小角度偏移
- **孵化机制**：
  - 虫卵在玩家位置生成后，2秒后自动孵化
  - 孵化出的自爆虫（charger类型）：
    - 速度：2.0
    - 血量：1
    - 体型：12
    - 接近玩家时会自爆
- **特效**：
  - 预警特效：红色危险警告粒子（15个粒子）
  - 颜色：红色渐变 (#FF0000, #FF4400, #FF8800)
- **限制机制**：
  - 当敌人总数超过80%上限时，不会生成新虫卵
  - 最多同时存在20个待孵化虫卵
  - 每次最多处理10个虫卵的孵化

#### 🔹 性能优化机制
- **虫卵数组限制**：
  - 超过30个时，只保留最近15个
  - 超过50个时，强制清空（防止卡死）

#### 🔹 接触伤害
- 近身接触时造成接触伤害

---

## 4. 第15层Boss：暗影刺客 (`void_shaman`)
**出现关卡**：第15层  
**基础属性**：
- 体型：基础大小的 **2.0倍**
- 血量：基础血量的 **50倍**
- 移动速度：0.5
- 颜色：亮紫色 (#ff00ff)

### 技能机制

#### 🔹 隐身系统
- **周期**：10秒一个周期
- **隐身时间**：前8秒隐身
- **现身时间**：后2秒现身
- **隐身效果**：
  - 隐身时移动速度提升 **50%**
  - 隐身时无法被看到（视觉上）
  - 隐身时不会造成接触伤害

#### 🔹 技能1：致命背刺
- **触发条件**：现身时且攻击冷却完成（2秒）
- **效果**：
  1. **闪现**：瞬间传送到玩家身后50像素位置
  2. **高额伤害**：造成玩家最大生命值的 **40%** 伤害
  3. **无敌帧**：玩家获得0.5秒无敌时间
- **特效**：
  - 暗影闪现：紫色粒子爆发（40个粒子）
  - 颜色：紫色渐变 (#FF00FF, #8800FF, #4400AA)
  - 屏幕闪光：紫色闪光效果（0.5秒，200毫秒）

#### 🔹 技能2：飞镖阵列
- **冷却时间**：18秒
- **效果**：发射6枚飞镖，均匀分布（360度圆形）
- **飞镖属性**：
  - 伤害：25 + 层数×4
  - 速度：7
  - 穿透：0（无法穿透）
  - 存在时间：600毫秒
- **特效**：
  - 飞镖充能：红色旋转粒子（80个粒子）
  - 颜色：红色渐变 (#FF0000, #FF4400, #FF8800)

#### 🔹 战斗策略
- 隐身时快速接近玩家
- 现身时立即使用背刺技能
- 配合飞镖阵列制造压力

---

## 5. 第20层Boss：混沌造物 (`legion_commander`)
**出现关卡**：第20层  
**基础属性**：
- 体型：基础大小的 **2.8倍**
- 血量：基础血量的 **80倍**
- 移动速度：0.6（随阶段变化）
- 颜色：黑色 (#000000)

### 技能机制

#### 🔹 三阶段战斗系统
根据血量百分比进入不同阶段：

**阶段1：混沌巨兽（100%-70%血量）**
- 近战型Boss
- 移动速度：基础速度的60%
- 接近玩家进行近战攻击

**阶段2：混沌织法者（70%-30%血量）**
- 远程型Boss
- 保持200像素距离
- 移动速度：基础速度（保持距离）

**阶段3：混沌本源（30%-0%血量）**
- 高速型Boss
- 移动速度：基础速度的1.5倍 × (1 + (1 - 血量百分比))
  - 血量越低，移动速度越快
  - 最低血量时速度可达基础速度的3倍

#### 🔹 阶段1技能：混沌重击
- **冷却时间**：9秒
- **攻击方式**：扇形范围攻击（60度角）
- **攻击范围**：150像素
- **伤害**：40 + 层数×8
- **特效**：
  - 能量聚集：橙红色能量波动（50个粒子）
  - 颜色：橙红渐变 (#FF4500, #FF8800, #FFAA00)
  - 屏幕震动：0.5秒，400毫秒

#### 🔹 阶段2技能：元素洪流
- **冷却时间**：12秒
- **攻击方式**：发射元素投射物（冰/火/雷交替）
- **元素循环**：每4秒切换一次元素
  - **冰元素**：蓝色 (#00AAFF, #88CCFF, #FFFFFF)
  - **火元素**：红色 (#FF4400, #FF8800, #FFAA00)
  - **雷元素**：紫色 (#AA00FF, #FF00FF, #FFFFFF)
- **投射物属性**：
  - 伤害：35 + 层数×6
  - 速度：9
  - 穿透：最多穿透2个敌人
  - 存在时间：500毫秒
- **特效**：
  - 元素能量爆发：对应元素的彩虹色粒子（80个粒子）
  - 扇形分布：40度角

#### 🔹 阶段3技能：混沌突袭
- **冷却时间**：8秒
- **攻击方式**：
  1. 高速冲刺到玩家位置
  2. 到达后造成伤害
- **伤害**：35 + 层数×6
- **特效**：
  - **起点特效**：彩虹尾迹粒子（120个粒子）
    - 颜色：彩虹色 (#FF0000, #FF8800, #FFFF00, #00FF00, #00AAFF, #8800FF, #FF00FF)
  - **终点特效**：爆炸碎片粒子（60个粒子）
    - 颜色：白紫渐变 (#FFFFFF, #FF00FF, #AA00FF)
  - **屏幕震动**：0.6秒，500毫秒，紫色闪光
- **无敌帧**：玩家获得0.3秒无敌时间

#### 🔹 战斗策略
- **阶段1**：近身战斗，使用重击技能
- **阶段2**：保持距离，使用元素洪流远程攻击
- **阶段3**：高速移动，频繁使用突袭技能

---

## Boss战斗通用机制

### 接触伤害
所有Boss在近身接触时都会造成接触伤害，伤害根据层数计算。

### 技能冷却系统
- 每个Boss都有独立的技能冷却时间
- 冷却时间不叠加，技能可以同时准备

### 阶段转换
- 多阶段Boss在血量达到阈值时会立即转换阶段
- 阶段转换时可能会有属性变化（如速度提升）

### 特效系统
- 所有技能都有对应的视觉特效
- 粒子效果数量已优化，避免性能问题

---

## Boss战斗建议

### 重装指挥官（第5层）
- 注意躲避重炮轰击的扇形攻击
- 优先清理召唤的小怪
- 保持移动，避免被包围

### 虫巢母体（第10层）
- 优先击杀快速虫，避免被包围
- 注意地面上的虫卵，及时远离
- 当虫卵孵化时，快速移动躲避
- Boss移动缓慢，可以利用这个特点

### 暗影刺客（第15层）
- 注意隐身/现身周期
- 现身时立即准备闪避背刺
- 飞镖阵列是圆形分布，找到安全空隙
- 保持移动，避免被背刺命中

### 混沌造物（第20层）
- **阶段1**：注意扇形重击的预警，及时躲避
- **阶段2**：保持距离，观察元素类型
- **阶段3**：高速移动，注意混沌突袭的冲刺，提前预判位置
- 所有阶段都要优先躲避技能，再输出伤害

