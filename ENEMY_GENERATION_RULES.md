# 敌人生成规则详细说明

## 核心原则：累积型敌人系统

**设计理念**：新敌人加入后，旧敌人不会消失，而是以更高概率继续出现，形成累积效应。

---

## 各层敌人详细列表

### **第1-2层**（只有基础敌人）
| 敌人类型 | 权重 | 出现概率 | 总权重 | 总概率 |
|---------|------|----------|--------|--------|
| 近战步兵 | 100  | 100%     | 100    | 100%   |

**特点**：纯新手教学，只有基础敌人

---

### **第3-4层**（引入快速虫）
| 敌人类型 | 权重 | 出现概率 | 总权重 | 累计概率 |
|---------|------|----------|--------|---------|
| 近战步兵 | 100  | 55.6%    | 180    | 55.6%   |
| 快速虫   | 80   | 44.4%    | 180    | 100%    |

**特点**：开始考验玩家走位和优先击杀

---

### **第5-6层**（引入弓箭手）
| 敌人类型 | 权重 | 出现概率 | 总权重 | 累计概率 |
|---------|------|----------|--------|---------|
| 近战步兵 | 100  | 41.7%    | 240    | 41.7%   |
| 快速虫   | 80   | 33.3%    | 240    | 75.0%   |
| 弓箭手   | 60   | 25.0%    | 240    | 100%    |

**特点**：开始需要关注远程威胁

---

### **第7-8层**（引入重装盾兵）
| 敌人类型 | 权重 | 出现概率 | 总权重 | 累计概率 |
|---------|------|----------|--------|---------|
| 近战步兵 | 100  | 34.5%    | 290    | 34.5%   |
| 快速虫   | 80   | 27.6%    | 290    | 62.1%   |
| 弓箭手   | 60   | 20.7%    | 290    | 82.8%   |
| 重装盾兵 | 50   | 17.2%    | 290    | 100%    |

**特点**：引入坦克类敌人，增加正面压力

---

### **第9-10层**（引入自爆蝠）
| 敌人类型 | 权重 | 出现概率 | 总权重 | 累计概率 |
|---------|------|----------|--------|---------|
| 近战步兵 | 100  | 30.3%    | 330    | 30.3%   |
| 快速虫   | 80   | 24.2%    | 330    | 54.5%   |
| 弓箭手   | 60   | 18.2%    | 330    | 72.7%   |
| 重装盾兵 | 50   | 15.2%    | 330    | 87.9%   |
| 自爆蝠   | 40   | 12.1%    | 330    | 100%    |

**特点**：增加空间管理难度

---

### **第11-12层**（引入治疗师）
| 敌人类型 | 权重 | 出现概率 | 总权重 | 累计概率 |
|---------|------|----------|--------|---------|
| 近战步兵 | 100  | 26.7%    | 375    | 26.7%   |
| 快速虫   | 80   | 21.3%    | 375    | 48.0%   |
| 弓箭手   | 60   | 16.0%    | 375    | 64.0%   |
| 重装盾兵 | 50   | 13.3%    | 375    | 77.3%   |
| 自爆蝠   | 40   | 10.7%    | 375    | 88.0%   |
| 治疗师   | 45   | 12.0%    | 375    | 100%    |

**特点**：引入最优先击杀目标

---

### **第13-14层**（引入投弹手）
| 敌人类型 | 权重 | 出现概率 | 总权重 | 累计概率 |
|---------|------|----------|--------|---------|
| 近战步兵 | 100  | 24.1%    | 415    | 24.1%   |
| 快速虫   | 80   | 19.3%    | 415    | 43.4%   |
| 弓箭手   | 60   | 14.5%    | 415    | 57.9%   |
| 重装盾兵 | 50   | 12.0%    | 415    | 69.9%   |
| 自爆蝠   | 40   | 9.6%     | 415    | 79.5%   |
| 治疗师   | 45   | 10.8%    | 415    | 90.3%   |
| 投弹手   | 40   | 9.6%     | 415    | 100%    |

**特点**：引入战场分割控制

---

### **第15-16层**（引入召唤师）
| 敌人类型 | 权重 | 出现概率 | 总权重 | 累计概率 |
|---------|------|----------|--------|---------|
| 近战步兵 | 100  | 22.2%    | 450    | 22.2%   |
| 快速虫   | 80   | 17.8%    | 450    | 40.0%   |
| 弓箭手   | 60   | 13.3%    | 450    | 53.3%   |
| 重装盾兵 | 50   | 11.1%    | 450    | 64.4%   |
| 自爆蝠   | 40   | 8.9%     | 450    | 73.3%   |
| 治疗师   | 45   | 10.0%    | 450    | 83.3%   |
| 投弹手   | 40   | 8.9%     | 450    | 92.2%   |
| 召唤师   | 35   | 7.8%     | 450    | 100%    |

**特点**：怪物数量可能失控

---

### **第17-18层**（引入幻影刺客）
| 敌人类型 | 权重 | 出现概率 | 总权重 | 累计概率 |
|---------|------|----------|--------|---------|
| 近战步兵 | 100  | 20.8%    | 480    | 20.8%   |
| 快速虫   | 80   | 16.7%    | 480    | 37.5%   |
| 弓箭手   | 60   | 12.5%    | 480    | 50.0%   |
| 重装盾兵 | 50   | 10.4%    | 480    | 60.4%   |
| 自爆蝠   | 40   | 8.3%     | 480    | 68.7%   |
| 治疗师   | 45   | 9.4%     | 480    | 78.1%   |
| 投弹手   | 40   | 8.3%     | 480    | 86.4%   |
| 召唤师   | 35   | 7.3%     | 480    | 93.7%   |
| 幻影刺客 | 30   | 6.3%     | 480    | 100%    |

**特点**：最终混合战场

---

### **第19-20层**（全类型混合）
所有9种敌人类型都会出现，权重分布同上。

---

## 特殊层设计

### **精英怪层**（第8、14、18层）
除了上述普通敌人外，有30%概率生成精英怪：
- 第8层：重装队长（精英版重装盾兵）
- 第14层：精英治疗师（更强的治疗）
- 第18层：幻影大师（分身技能）

### **Boss层**（第5、10、16、20层）
**注意**：当前Boss生成逻辑已禁用，改为纯普通敌人生成。

---

## 生成机制说明

1. **权重系统**：旧敌人保持高权重（100），新敌人权重较低（30-60）
2. **累积原理**：每个新敌人加入时，总权重增加，旧敌人概率下降但不会消失
3. **起始层**：每个敌人都有自己的`layerStart`属性，只有达到该层才会加入池子
4. **过滤机制**：`getAvailableEnemyTypes`方法会根据当前层数过滤可生成的类型

---

## 验证清单

- [x] 第1层：只有近战步兵
- [x] 第3层：近战步兵 + 快速虫
- [x] 第5层：近战步兵 + 快速虫 + 弓箭手
- [x] 第7层：近战步兵 + 快速虫 + 弓箭手 + 重装盾兵
- [x] 第9层：以上全部 + 自爆蝠
- [x] 第11层：以上全部 + 治疗师
- [x] 第13层：以上全部 + 投弹手
- [x] 第15层：以上全部 + 召唤师
- [x] 第17层：以上全部 + 幻影刺客
- [x] 第20层：所有9种类型混合

